(function(){"use strict";var e={2610:function(e,t,s){var a=s(9242),o=s(3396);function n(e,t,s,a,n,i){const r=(0,o.up)("Modal"),l=(0,o.up)("router-view");return(0,o.wg)(),(0,o.iD)(o.HY,null,[e.message?((0,o.wg)(),(0,o.j4)(r,{key:0,onClose:t[0]||(t[0]=t=>e.message=!1),message:e.messageObject},null,8,["message"])):(0,o.kq)("",!0),(0,o.Wm)(l,{onMessage:t[1]||(t[1]=t=>e.setMessage(t))})],64)}var i=s(7139);const r={class:"modal_backdrop"},l={class:"modal"},c={class:"modal_header"},d={class:"modal_text"};function u(e,t,s,a,n,u){return(0,o.wg)(),(0,o.iD)("div",r,[(0,o._)("div",l,[(0,o._)("header",c,(0,i.zw)(e.message.header),1),(0,o._)("div",d,(0,i.zw)(e.message.text),1),(0,o._)("button",{type:"button",class:"btn_close",onClick:t[0]||(t[0]=t=>e.$emit("close"))}," Close ")])])}var p=(0,o.aZ)({name:"ErrorModal",props:{message:{type:Object,required:!0}},emits:["close"]}),m=s(89);const h=(0,m.Z)(p,[["render",u]]);var g=h,f=(0,o.aZ)({name:"App",components:{Modal:g},data(){return{message:!1,messageObject:{}}},methods:{setMessage(e){this.message=!0,this.messageObject={text:e.text,header:e.header}}}});const _=(0,m.Z)(f,[["render",n]]);var b=_,w=s(5431);(0,w.z)("/repair-registration-widget/service-worker.js",{ready(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered(){console.log("Service worker has been registered.")},cached(){console.log("Content has been cached for offline use.")},updatefound(){console.log("New content is downloading.")},updated(){console.log("New content is available; please refresh.")},offline(){console.log("No internet connection found. App is running in offline mode.")},error(e){console.error("Error during service worker registration:",e)}});var E=s(2483);const S=e=>((0,o.dD)("data-v-4ca28944"),e=e(),(0,o.Cn)(),e),v=S((()=>(0,o._)("h3",{class:"header"},"Записаться на ремонт",-1))),N={class:"field-block"},I=S((()=>(0,o._)("label",{class:"label",for:"carRegNumber"},"Гос №*",-1))),M=S((()=>(0,o._)("span",{id:"carRegNumberValid",class:"input-pseudo"},null,-1))),D={class:"field-block"},k=S((()=>(0,o._)("label",{class:"label",for:"phone"},"Телефон*",-1))),R=S((()=>(0,o._)("option",{selected:"",value:"+7"},"+7",-1))),y=S((()=>(0,o._)("option",{value:"+372"},"+372",-1))),C=[R,y],O=S((()=>(0,o._)("span",{id:"phoneValid",class:"input-pseudo"},null,-1))),A={class:"field-block"},T=S((()=>(0,o._)("label",{class:"label",for:"ownerName"},"Имя*",-1))),z=S((()=>(0,o._)("span",{id:"ownerNameValid",class:"input-pseudo"},null,-1))),L={class:"field-block"},x=S((()=>(0,o._)("label",{class:"label",for:"station"},"Станция*",-1))),H=["value"],j=S((()=>(0,o._)("span",{class:"input-pseudo"},null,-1))),U={class:"field-block"},B=S((()=>(0,o._)("label",{class:"label",for:"mark"},"Марка*",-1))),P=["value"],$=S((()=>(0,o._)("span",{class:"input-pseudo"},null,-1))),K={class:"field-block"},V=S((()=>(0,o._)("label",{class:"label",for:"model"},"Модель*",-1))),Z=["value"],q=S((()=>(0,o._)("span",{class:"input-pseudo"},null,-1))),Y={class:"field-block"},G=S((()=>(0,o._)("label",{class:"label",for:"description"},"Что требуется сделать*",-1))),F=S((()=>(0,o._)("span",{id:"descriptionValid",class:"input-pseudo"},null,-1))),W={class:"field-block"},J=S((()=>(0,o._)("label",{class:"label",for:"confirmCost"},"Предварительно согласовать стоимость",-1))),X=S((()=>(0,o._)("span",{class:"input-pseudo"},null,-1))),Q={class:"field-block"},ee=S((()=>(0,o._)("label",{class:"label",for:"date"},"Дата*",-1))),te=["min","max"],se=S((()=>(0,o._)("span",{class:"input-pseudo"},null,-1))),ae={class:"field-block"},oe=S((()=>(0,o._)("label",{class:"label",for:"timeHours"},"Время",-1))),ne=S((()=>(0,o._)("span",null,":",-1))),ie=S((()=>(0,o._)("span",{class:"input-pseudo"},null,-1))),re=S((()=>(0,o._)("input",{type:"submit",value:"ЗАПИСАТЬСЯ",id:"submit"},null,-1)));function le(e,t,s,n,r,l){return(0,o.wg)(),(0,o.iD)("form",{class:"container",onSubmit:t[19]||(t[19]=(0,a.iM)(((...t)=>e.submit&&e.submit(...t)),["prevent"]))},[v,(0,o._)("div",N,[I,(0,o.wy)((0,o._)("input",{required:"",class:"input-field",id:"carRegNumber",pattern:"[А-Яа-яA-Za-z]{1}[0-9]{3}[А-Яа-яA-Za-z]{2}[0-9]{2,3}",placeholder:"А999АА999",type:"text","onUpdate:modelValue":t[0]||(t[0]=t=>e.carRegNumber=t),onChange:t[1]||(t[1]=(...t)=>e.getCarInfo&&e.getCarInfo(...t))},null,544),[[a.nr,e.carRegNumber]]),M]),(0,o._)("div",D,[k,(0,o.wy)((0,o._)("select",{name:"",id:"phoneCode","onUpdate:modelValue":t[2]||(t[2]=t=>e.phoneCode=t)},C,512),[[a.bM,e.phoneCode]]),(0,o.wy)((0,o._)("input",{required:"",type:"tel",pattern:"[0-9]{3}-?[0-9]{3}-?[0-9]{4}",placeholder:"999-999-9999",id:"phone","onUpdate:modelValue":t[3]||(t[3]=t=>e.phone=t),onChange:t[4]||(t[4]=t=>e.checkPhone())},null,544),[[a.nr,e.phone]]),O]),(0,o._)("div",A,[T,(0,o.wy)((0,o._)("input",{required:"",pattern:"[А-Яа-яA-Za-z ]{3,}",class:"input-field",type:"text",id:"ownerName","onUpdate:modelValue":t[5]||(t[5]=t=>e.ownerName=t),onChange:t[6]||(t[6]=t=>e.checkOwnerName())},null,544),[[a.nr,e.ownerName]]),z]),(0,o._)("div",L,[x,(0,o.wy)((0,o._)("select",{required:"",class:"input-field",id:"station","onUpdate:modelValue":t[7]||(t[7]=t=>e.station=t)},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.stations,(e=>((0,o.wg)(),(0,o.iD)("option",{value:e,key:e.Id},(0,i.zw)(e.Name),9,H)))),128))],512),[[a.bM,e.station]]),j]),(0,o._)("div",U,[B,(0,o.wy)((0,o._)("select",{required:"",class:"input-field",id:"mark","onUpdate:modelValue":t[8]||(t[8]=t=>e.mark=t),onChange:t[9]||(t[9]=t=>e.getModelsByMark(String(e.mark.MARK_ID)))},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.marks,(e=>((0,o.wg)(),(0,o.iD)("option",{value:e,key:e.MARK_ID},(0,i.zw)(e.MARK_NAME_RUS),9,P)))),128))],544),[[a.bM,e.mark]]),$]),(0,o._)("div",K,[V,(0,o.wy)((0,o._)("select",{required:"",class:"input-field",id:"model","onUpdate:modelValue":t[10]||(t[10]=t=>e.model=t)},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.models,(e=>((0,o.wg)(),(0,o.iD)("option",{value:e,key:e.MODEL_ID},(0,i.zw)(e.MODEL_NAME),9,Z)))),128))],512),[[a.bM,e.model]]),q]),(0,o._)("div",Y,[G,(0,o.wy)((0,o._)("textarea",{required:"",class:"input-field",cols:"30",rows:"10",id:"description","onUpdate:modelValue":t[11]||(t[11]=t=>e.description=t),onChange:t[12]||(t[12]=t=>e.checkDescription())},"\n      ",544),[[a.nr,e.description]]),F]),(0,o._)("div",W,[J,(0,o.wy)((0,o._)("input",{class:"input-field",type:"checkbox",id:"confirmCost","onUpdate:modelValue":t[13]||(t[13]=t=>e.confirmCost=t)},null,512),[[a.e8,e.confirmCost]]),X]),(0,o._)("div",Q,[ee,(0,o.wy)((0,o._)("input",{required:"",class:"input-field",type:"date",min:(new Date).toISOString().split("T")[0],max:new Date((new Date).setMonth((new Date).getMonth()+1)).toISOString().split("T")[0],id:"date","onUpdate:modelValue":t[14]||(t[14]=t=>e.date=t)},null,8,te),[[a.nr,e.date]]),se]),(0,o._)("div",ae,[oe,(0,o.wy)((0,o._)("select",{id:"timeHours","onUpdate:modelValue":t[15]||(t[15]=t=>e.timeHours=t),onChange:t[16]||(t[16]=t=>e.time=e.timeHours+":"+e.timeMinutes)},[((0,o.wg)(),(0,o.iD)(o.HY,null,(0,o.Ko)(["08","09","10","11","12","13","14","15","16","17","18","19","20"],(e=>(0,o._)("option",{key:e},(0,i.zw)(e),1))),64))],544),[[a.bM,e.timeHours]]),ne,(0,o.wy)((0,o._)("select",{id:"timeMinutes","onUpdate:modelValue":t[17]||(t[17]=t=>e.timeMinutes=t),onChange:t[18]||(t[18]=t=>e.time=e.timeHours+":"+e.timeMinutes)},[((0,o.wg)(),(0,o.iD)(o.HY,null,(0,o.Ko)(["00","15","30","45"],(e=>(0,o._)("option",{key:e},(0,i.zw)(e),1))),64))],544),[[a.bM,e.timeMinutes]]),ie]),re],32)}s(1703),s(2801);var ce=(0,o.aZ)({data(){return{carRegNumber:"",SESSIONID:"",VIN:"XWEHC812BA0001991",phoneCode:"+7",phone:"",ownerName:"",station:{},stations:new Array,mark:{},marks:new Array,model:{},models:new Array,description:"",confirmCost:!0,date:"",time:"08:00",timeHours:"08",timeMinutes:"00",authorizationIntervalID:0}},name:"MainPage",components:{},async created(){this.authorizationIntervalID=setInterval((()=>{this.auth()}),12e5),await this.auth();try{const e=`https://zenon.basgroup.ru:55724/api-v2/Core/RW/Directories/LDepartmentsCombo?SESSIONID=${this.SESSIONID}`,t=await fetch(e),s=await t.json();0===s.result.Status&&(this.stations=s.result.Response.LDepartmentsCombo.data)}catch(e){e instanceof Error&&console.log(e.message)}try{const e=`https://zenon.basgroup.ru:55724/api-v2/Core/Directories/Marks?SESSIONID=${this.SESSIONID}`,t=await fetch(e),s=await t.json();0===s.result.Status&&(this.marks=s.result.Response.Marks.data)}catch(e){e instanceof Error&&console.log(e.message)}},methods:{async auth(){try{const e="TEH_TEST",t="a1b2c3D$",s="92ae9e4c96394cf2aa2f462a5fde3b19",a=`https://zenon.basgroup.ru:55724/api-v2/auth/login?API_KEY=${s}`;let o=new Headers;o.set("Authorization","Basic "+btoa(e+":"+t));const n=await fetch(a,{method:"GET",headers:o}),i=await n.json();this.SESSIONID=i.SESSIONID}catch(e){e instanceof Error&&console.log(e.message)}},checkCarRegNumber(){this.carRegNumber=this.carRegNumber.trim().toUpperCase(),this.check("[А-Яа-яA-Za-z]{1}[0-9]{3}[А-Яа-яA-Za-z]{2}[0-9]{2,3}",this.carRegNumber,document.getElementById("carRegNumber"))},checkPhone(){this.phone=this.phone.trim().replace(" ","").replaceAll("-",""),this.check("[0-9]{3}-?[0-9]{3}-?[0-9]{4}",this.phone,document.getElementById("phone"))},checkOwnerName(){this.ownerName=this.ownerName.trim(),this.check("[А-Яа-яA-Za-z ]{3,}",this.ownerName,document.getElementById("ownerName"))},checkDescription(){this.check("[А-Яа-яA-Za-z ]{3,}",this.description,document.getElementById("description"))},async getCarInfo(){this.checkCarRegNumber();const e=`https://zenon.basgroup.ru:55724/api-v2/Core/Directories/CarsByGosreg/${this.carRegNumber}?SESSIONID=${this.SESSIONID}`,t=await fetch(e);if(200===t.status){const e=await t.json();if(0===e.result.Status&&e.result.Response.CarsByGosreg.data.length){const t=e.result.Response.CarsByGosreg.data[0];this.ownerName=t.POLICY_CAR_OWNER,this.checkOwnerName();const s=this.marks.find((e=>e.MARK_NAME_RUS===t.POLICY_MARK));s&&(this.mark=s),await this.getModelsByMark(String(this.marks.find((e=>e.MARK_NAME_ENG===t.POLICY_MARK))?.MARK_ID));const a=this.models.find((e=>e.MODEL_NAME===t.POLICY_MODEL));a&&(this.model=a);const o=`https://zenon.basgroup.ru:55724/api-v2/Core/Directories/Customer/${t.PROPERTY_CUSTOMER_ID}?SESSIONID=${this.SESSIONID}`,n=await fetch(o),i=await n.json();if(0===i.result.Status){const e=i.result.Response.Customer.data;this.phone=e.PHONE.substring(1),this.checkPhone(),this.ownerName=e.FIRST_NAME+" "+e.SECOND_NAME}}else{const e=`https://zenon.basgroup.ru:55724/api-v2/ExtRequests/rsaExtended?SESSIONID=${this.SESSIONID}&GOSREG=${this.carRegNumber}`,t=await fetch(e),s=await t.json();if(0===s.result.Status){const e=this.marks.find((e=>e.MARK_NAME_RUS===s.result.Response.rsaExtended.carMark));e&&(this.mark=e),await this.getModelsByMark(String(this.marks.find((e=>e.MARK_NAME_ENG===s.result.Response.rsaExtended.carMark))?.MARK_ID));const t=this.models.find((e=>e.MODEL_NAME===s.result.Response.rsaExtended.carModel));t&&(this.model=t),this.ownerName=s.result.Response.rsaExtended.insurantFio}}}},check(e,t,s){const a=new RegExp(e),o=a.test(t);s&&(o?(s.classList.remove("not-valid"),s.classList.add("valid")):(s.classList.add("not-valid"),s.classList.remove("valid")))},clearForm(){this.carRegNumber="",this.ownerName="",this.phone="",this.station={},this.mark={},this.model={},this.description="",this.confirmCost=!0,this.date="",this.timeHours="08",this.timeMinutes="00",this.time="08:00",document.getElementById("carRegNumber")?.classList.remove("valid"),document.getElementById("ownerName")?.classList.remove("valid"),document.getElementById("phone")?.classList.remove("valid"),document.getElementById("description")?.classList.remove("valid")},async getModelsByMark(e){const t=`https://zenon.basgroup.ru:55724/api-v2/Core/Directories/ModelsCombo/${e}?SESSIONID=${this.SESSIONID}`,s=await fetch(t),a=await s.json();this.models=a.result.Response.ModelsCombo.data},async submit(){const e={CLIENT_NAME:this.ownerName,CLIENT_PHONE:this.phoneCode.concat(this.phone),LDEPARTMENT_ID:this.station.Id,CREATE_DATE:this.date+" "+this.time+":00",START:this.date+" "+this.time+":00",DURATION:1,GOSREG:this.carRegNumber,MODEL_ID:this.model.MODEL_ID,COMMENT:this.description},t=`https://zenon.basgroup.ru:55724/api-v2/Core/RW/ScheduledCar?SESSIONID=${this.SESSIONID}`,s=await fetch(t,{method:"POST",body:JSON.stringify(e)}),a=await s.json();if(0===a.result.Status){const e=a.result.Response.ScheduledCar.data;a.result.Response.ScheduledCar.data.START,a.result.Response.ScheduledCar.data.SCHEDULE_ID,a.result.Response.ScheduledCar.data.WRITER_NAME,this.setMessage({header:"Вы записаны!",text:`Время записи: ${e.START}.\nВаш ID: ${e.SCHEDULE_ID}.\nВаш менеджер: ${e.WRITER_NAME}`}),this.clearForm()}else this.setMessage({header:"Не удалось записаться",text:"Попробуйте выбрать другое время"})},setMessage(e){this.$emit("message",e)}}});const de=(0,m.Z)(ce,[["render",le],["__scopeId","data-v-4ca28944"]]);var ue=de;const pe=[{path:"/",name:"home",component:ue}],me=(0,E.p7)({history:(0,E.PO)("/repair-registration-widget/"),routes:pe});var he=me,ge=s(65),fe=(0,ge.MT)({state:{},getters:{},mutations:{},actions:{},modules:{}});(0,a.ri)(b).use(fe).use(he).mount("#app")}},t={};function s(a){var o=t[a];if(void 0!==o)return o.exports;var n=t[a]={exports:{}};return e[a](n,n.exports,s),n.exports}s.m=e,function(){var e=[];s.O=function(t,a,o,n){if(!a){var i=1/0;for(d=0;d<e.length;d++){a=e[d][0],o=e[d][1],n=e[d][2];for(var r=!0,l=0;l<a.length;l++)(!1&n||i>=n)&&Object.keys(s.O).every((function(e){return s.O[e](a[l])}))?a.splice(l--,1):(r=!1,n<i&&(i=n));if(r){e.splice(d--,1);var c=o();void 0!==c&&(t=c)}}return t}n=n||0;for(var d=e.length;d>0&&e[d-1][2]>n;d--)e[d]=e[d-1];e[d]=[a,o,n]}}(),function(){s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,{a:t}),t}}(),function(){s.d=function(e,t){for(var a in t)s.o(t,a)&&!s.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};s.O.j=function(t){return 0===e[t]};var t=function(t,a){var o,n,i=a[0],r=a[1],l=a[2],c=0;if(i.some((function(t){return 0!==e[t]}))){for(o in r)s.o(r,o)&&(s.m[o]=r[o]);if(l)var d=l(s)}for(t&&t(a);c<i.length;c++)n=i[c],s.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return s.O(d)},a=self["webpackChunkrepair_registration_widget"]=self["webpackChunkrepair_registration_widget"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=s.O(void 0,[998],(function(){return s(2610)}));a=s.O(a)})();
//# sourceMappingURL=app.31b4f5af.js.map